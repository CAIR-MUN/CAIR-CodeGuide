This chapter provides practical guidance for containerized services,
media servers, and virtual machine configuration in data center
projects.

## 11.1 Docker & Containers

- Keep images small and single-purpose. Favor multi-stage builds to
  avoid shipping build tools in runtime images.
- Run processes as non-root inside containers where possible.
- Pin base image versions and scan images for vulnerabilities.
- Use environment variables for configuration and avoid baking secrets
  into images.

### Dockerfile example (multi-stage, small runtime)

```dockerfile
# build stage
FROM node:18-alpine AS build
WORKDIR /app
COPY package*.json ./
RUN npm ci --production=false
COPY . .
RUN npm run build

# runtime stage
FROM node:18-alpine
WORKDIR /app
COPY --from=build /app/dist ./dist
COPY package*.json ./
RUN npm ci --production
USER node
CMD ["node", "dist/index.js"]
```

## 11.2 Media Servers (transcoding / streaming)

- Right-size resources: media processing is CPU and I/O heavy â€” allocate
  dedicated nodes or scale horizontally.
- Use hardware acceleration where available (VAAPI, NVENC) for high
  throughput.
- Prefer stateless frontends and persist media files in object storage
  (S3-compatible) or shared storage with strong consistency guarantees.
- Secure media endpoints and validate uploaded content (limits, mime
  types, virus scanning).

## 11.3 Virtual Machines and Orchestration

- Use VM images with minimal surface area and automated provisioning
  (Cloud-init, configuration management).
- For production deployments, prefer orchestration (Kubernetes, Nomad)
  for container orchestration and scaling.
- Define clear resource limits and request settings for containers and
  VMs to avoid noisy-neighbor issues.

## 11.4 Backups and Recovery

- Regularly back up configuration and critical data with tested restore
  procedures.
- Use immutable artifacts (images, artifacts with checksums) in
  production pipeline.

## 11.5 Security & Operations

- Scan images and VMs for vulnerabilities; automate patching where safe.
- Use centralized logging and monitoring for operational visibility.
- Apply least privilege on service accounts and access keys.
